---
title: График работы сотрудников
date: 2019-06-24
image: images/blog/dev_002_foto.jpg
author: Smile
---

> *Рвав-рвав, собака Смайл на связи!*
>
> *Представляем вашему вниманию свою 2-ю разработку комплекта отчетности "Офисная жизнь" -- отчет "График работы сотрудников", иллюстрирующий доступность сотрудников в плане выполнения поставленных задач.*
>

![График работы сотрудников](https://kkadikin.ru/images/blog/dev_002_screen.jpg)

Отчет реализован при помощи DAX и Power Query, и построен на базе производственного календаря.

**Помимо распределения нерабочих дней согласно календарю, содержит следующие расчеты, которые можно получить по каждому работнику:** 

**<li>** Количество рабочих дней;

**<li>** Количество дней отпуска;

**<li>** Количество взятых отгулов;

**<li>** Количество дней болезни.

Все показатели рассчитаны при помощи мер на уровне DAX, а исходный набор дат получен при помощи Power Query (см. отчет [Производственный календарь](https://kkadikin.ru/ru/blog/development_ru/dev_001/))


**Разработка содержит 2 листа:**

**<li>** Собственно, сам отчет.

**<li>** Памятка пользователя.

**Используемые элементы:**

**<li>** Скрывающаяся панель фильтров (стандартный функционал);

**<li>** Кнопки;

**<li>** Закладки;

**<li>** В качестве основного элемента используется "Matrix" ("Матрица"), а дополнительного -- "Card" ("Карточка");

**<li>** Иконки;

**<li>** Дополнительные украшательства -- "Text box" ("Текстовое поле"), "Shapes" ("Фигуры").

**Процесс разработки:**

**<li>** Для указания базового промежутка времени на уровне Power Query были созданы параметры "Start_Date" и "End_Date"  -- это даты начала и окончания периода, которые выведены в заголовок отчета.

**<li>** Создана таблица "Calendar" -- базовая таблица, определяющая набор дат для расчета.

**<li>** Создана таблица "Russian_Holidays" -- таблица настройки, содержащая список российских праздников.

**<li>** Создана таблица "Break_Days" -- таблица настройки, содержащая даты так называемых "перенесенных" дней.

**<li>** Создана таблица "Measure" -- техническая таблица, созданная для удобства.

**<li>** Создана таблица "Options" -- содержит параметры отчета для указания необходимого отрезка времени.

**<li>** Создана таблица "Dataset" -- содержит набор исходных данных, который имеет минимально необходимую структуру, а именно: наименование сотрудника, начальную и конечную даты его отсутствия, и, собственно, причину.

**<li>** Создана таблица "Legend" -- вспомогательная таблица, позволяющая при помощи цифровой метки осуществить цветовое обозначение.

**<li>** Создана таблица "Employees" -- справочник сотрудников.

**<li>** Создана таблица "Time_Off" -- содержит перечень дат отсутствия и причину по каждому сотруднику в виде, когда каждая строка таблицы представляет собой одну конкретную дату.

**<li>** Создана таблица "Time_all" -- содержит общий перечень дат за указанный период по каждому сотруднику в виде, когда каждая строка таблицы представляет собой одну конкретную дату.

На этом работы с Power Query завершены. 

**<li>** Следующим этапом является проверка связей получившейся модели данных, и их корректировка в случае необходимости. Схема связей представлена ниже:

![dev_002_relations](https://kkadikin.ru/images/blog/dev_002_relations.jpg)

**<li>** Затем при помощи DAX начинаем формировать нужные аналитические разрезы, например, производим деление общего массива данных, сформированного в таблице "Time_all" на дополнительные составляющие: рабочие дни, нерабочие календарные дни, и, собственно, те дни, когда сотрудник должен быть на рабочем месте, но при этом он отсутвует по определенной обозначенной причине.

**<li>** Далее при помощи мер рассчитываются сводные показатели по компании: рабочее время, время сотрудника, время, соответствующее отпуску, время, проведенное на больничном, или в отгулах. 

**<li>** Когда все готово, можно приступать к визуализации данных;

**<li>** Последний шаг -- это дизайн, но тут уже раздумий не надо - все оформлено в соответствии со стилем, используемым в предыдущем отчете [Производственный календарь](https://kkadikin.ru/ru/blog/development_ru/dev_001/)).

**Особенности разработки:**

**<li>** Работа и функционал созданного календаря подробно описана в предыдущейй статье, все преимущества сохранены.

**<li>** При разработке сделано допущение, что сотрудник либо присутствует на работе, либо нет. Соответственно, время отсутствия сотрудника рассчитывается в днях. Частичное отсутствие в офисе (например, 1 час) не реализовано по идеологическим соображениям, поскольку нужная степень детализации может завести очень далеко). Все зависит от того, с какой точностью нужна информация, и насколько вы готовы обеспечить эту самую точность)

**<li>** Как вы, наверное, уже поняли из описания выше, поскольку мы визуализируем все рабочее время сотрудника за указанный период времени (например, год), то, в зависимости от количества сотрудников на каждую единицу создается массив в 365 записей.
Несмотря на это, простота модели обеспечивает быстрое обновление данных, и даже при 1000 сотрудников у вас не возникнет никаких проблем.

**<li>** При разработке отчета данные исходного набора значений вносились непосредственно в Power BI (таблица "Dataset"), дабы конечный файл не зависел от внешних источников. Переключение на внешние источники данных не составляет проблем.

> *Как я уже говорил, удобство и простота -- наше кредо!*
>
> *Ушел проверять миску, вдруг чего изменилось...*
>
> *Ваш Смайл*

**ДЛЯ ЛЮБИТЕЛЕЙ ПОНАЖИМАТЬ НА КНОПОЧКИ**

<iframe width="800" height="600" src="https://app.powerbi.com/view?r=eyJrIjoiOWUzMDgwMTQtNTIxYi00OTA4LTg5NjMtNjg2M2UyMjI3NDk2IiwidCI6IjE4YjFiOTZhLTk0MTQtNDE3MC1iNmNhLTZkODU3NTJlNTZmOCIsImMiOjZ9" frameborder="0" allowFullScreen="true"></iframe>