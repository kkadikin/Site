---
title: День рождения в коллективе
date: 2020-07-25
image: images/blog/dev_003_foto.jpg
author: Smile
---

> *Рвав-рвав, собака Смайл спешит поделиться новостью!*
>
> *Представляем вашему вниманию свою 3-ю разработку комплекта отчетности "Офисная жизнь" -- отчет "День рождения в коллективе", иллюстрирующий праздничные события.*
>

![dev_003_screen](https://kkadikin.ru/images/blog/dev_003_screen.jpg)

Отчет реализован при помощи DAX и Power Query, и построен на базе производственного календаря (см. отчет [Производственный календарь](https://kkadikin.ru/ru/blog/development_ru/dev_001/)).

> *Рвав-рвав, да, вы не ошиблись, это снова он -- Производственный календарь. Собака Смайл всегда знает, что надо сделать в первую очередь, потому что, несмотря на кажущуюся простоту и обыденность, без этой штуки любому офису никуда!*


**Разработка содержит 2 листа:**

**<li>** Лист «Отчет» -- собственно, сам отчет, содержащий детальные данные по работникам; 

**<li>** Лист «Информация» -- Памятка пользователя.


**Используемые элементы:**

**<li>** Кнопки;

**<li>** Иконки;

**<li>** Закладки;

**<li>** В качестве основного элемента используется "Table" ("Таблица"), а дополнительных -- "Card" ("Карточка") и "Treemap" ("Диаграмма дерева");

**<li>** Дополнительные украшательства -- "Text box" ("Текстовое поле"), "Shapes" ("Фигуры").


**Процесс разработки:**

**<li>** Для указания базового промежутка времени на уровне Power Query были созданы параметры "Начало периода" и "Конец периода" -– это даты начала и окончания периода, которые выведены в название отчета.

**<li>** Создана таблица "Календарь" -- базовая таблица, определяющая набор дат для расчета.

**<li>** Создана таблица "Праздники" -- таблица настройки, содержащая список российских праздников.

**<li>** Создана таблица "Переносы" -- таблица настройки, содержащая даты так называемых "перенесенных" дней.

**<li>** Создана таблица "Меры" -- техническая таблица, созданная для удобства, складываем туда меры (по старинке), хоть теперь можно их группировать при помощи каталогов.

**<li>** Создана таблица "Параметры" -- содержит параметры отчета для указания необходимого отрезка времени.

**<li>** Создана таблица "Даты рождения" -- содержит набор исходных данных, который имеет минимально необходимую структуру, а именно: сотрудника, дату его рождения, позицию в компании и гендерную принадлежность.

> *Рвав-рвав, для тех, кто не знает, это мальчики или девочки (тут нежное "Рвав-рвав-рвав").*

**<li>** Создана таблица "Сотрудники" -- справочник сотрудников.

**<li>** Создана таблица "Позиции" -- справочник позиции сотрудника в компании, то есть это его функциональная роль.

На этом работы с Power Query завершены. 

**<li>** Следующим этапом является проверка связей получившейся модели данных, и их корректировка в случае необходимости. Схема связей представлена ниже:

![dev_002_relations](https://kkadikin.ru/images/blog/dev_003_relations.jpg)

**<li>** Затем при помощи DAX начинаем формировать нужные аналитические разрезы и дополнительные маркеры в таблице «Даты рождения»: например, выводим признак того, совпадает праздник с юбилеем, или нет.

**<li>** Далее при помощи мер рассчитывается количество участников поздравления, а также ориентировочный бюджет подарка на человека, в зависимости от его функциональной роли. Конечно, это можно было сделать параметрами, но, поскольку данное значение не меняется часто, при разработке была использована постоянная сумма сбора: 100 руб. на сотрудника, 200 руб. на руководителя, и 300 руб. на ТОП-менеджера.

**<li>** При визуализации данных были использованы иконки условного форматирования, появившиеся в последнем апдейте. 

**<li>** Предупреждение о празднике, для особо забывчивых, высвечивается за неделю.

**<li>** Последний шаг -- это дизайн, тут придерживаемся единого стиля)

**Особенности разработки:**

**<li>** Работа и функционал созданного календаря подробно описана в предыдущей статье, все преимущества сохранены.

**<li>** При разработке сделано допущение, что предупреждать о дне рождения нужно за одну неделю. В принципе, можно легко изменить указанный срок при помощи встроенного фильтра.

**<li>** Отчет имеет встроенную систему маркеров следующего вида:

-- поздравить нужно сегодня;

-- праздник является юбилеем, для расчета используется промежуток от 15 до 70 лет;

-- напоминание о покупке цветов (делалось для забывчивых мальчиков, если именинник - девочка), однако по запросу можно дополнить данный механизм;

> *Рвав-рвав, собака Смайл - толерантный, современный пес!*

**<li>** Дополнительно обозначен размер презента.

> *Рвав-рвав, товарищи, данная разработка -- просто мечта, она реально необходима в каждый офис!*
>
> *За сим -- прощаюсь, пойду играть с маленькой хозяйкой, приобрел себе новую игрушку, но, видимо, не совсем себе, а на двоих...*
>
> *Ваш Смайл*


**ДЛЯ ЛЮБИТЕЛЕЙ ПОНАЖИМАТЬ НА КНОПОЧКИ**

<iframe width="600" height="373.5" src="https://app.powerbi.com/view?r=eyJrIjoiNDNlZjY4YzYtOWYzNS00ZDg0LWE0MDctYjI5OTQzZTU4MjNhIiwidCI6IjE4YjFiOTZhLTk0MTQtNDE3MC1iNmNhLTZkODU3NTJlNTZmOCIsImMiOjZ9" frameborder="0" allowFullScreen="true"></iframe>