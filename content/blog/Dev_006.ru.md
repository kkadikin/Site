---
title: Распределение задач по исполнителям
date: 2021-07-04
image: images/blog/dev_006_foto.jpg
author: Smile
---

> *Рвав-рвав, собака Смайл творит, лёжа пластом!*
>
> *Представляем вашему вниманию свою 6-ю разработку комплекта отчетности "Офисная жизнь" -- отчет «Распределение задач по исполнителям», иллюстрирующий график выполнения задач при помощи построения диаграммы Ганта.*
>

![Распределение задач по исполнителям](https://kkadikin.ru/images/blog/dev_006_screen.jpg)

Отчет реализован при помощи DAX и Power Query.


**Разработка содержит 2 листа:**

**<li>** Лист "Отчет" -- собственно, сам отчет, содержащий сводные и детальные данные по работникам;

**<li>** Лист "Информация" -- памятка пользователя.


**Используемые элементы:**

**<li>** Кнопки.

**<li>** Иконки.

**<li>** В качестве основного элемента используется "Matrix" ("Матрица"), а дополнительного -- "Card" ("Карточка").

**<li>** Дополнительные украшательства -- "Text box" ("Текстовое поле"), "Shapes" ("Фигуры").


**Процесс разработки:**

**<li>** Для указания базового промежутка времени на уровне Power Query были созданы параметры "Начало периода" и "Конец периода" – это даты начала и окончания периода, которые выведены в название отчета.

**<li>** Создана таблица "Меры" -- техническая таблица, созданная для удобства.

**<li>** Создана таблица "Параметры" -- содержит параметры отчета для указания необходимого отрезка времени.

**<li>** Создана таблица "Перечень задач" -- содержит набор исходных данных, который имеет минимально необходимую структуру, а именно: название проекта, номер задачи и ее исполнителя, начальную и конечную даты выполнение задачи.

**<li>** Создана таблица "Легенда" -- таблица, являющаяся фильтром, и описывающая цветовое обозначение.

**<li>** Создана таблица "Выполнение задач по датам" -- таблица содержит перечень дат выполнения задачи по каждому сотруднику, в виде, при котором каждая строка таблицы представляет собой одну конкретную дату.

На этом работы с Power Query завершены.

**<li>** На уровне модели данных создана таблица "Календарь" -- базовая таблица, определяющая набор дат для расчета.

**<li>** Следующим этапом является проверка связей получившейся модели данных, и их корректировка в случае необходимости. Схема связей представлена ниже:

![dev_002_relations](https://kkadikin.ru/images/blog/dev_006_relations.jpg)

**<li>** Затем, при помощи DAX, начинаем формировать нужные аналитические разрезы, например, производим деление общего массива данных, сформированного в таблице "Выполнение задач по датам" на дополнительные составляющие: "Выполненные задачи", "Текущие задачи", "Планируемые задачи".

**<li>** Создаем метки для дальнейшего применения условного форматирования.

**<li>** Когда все готово, можно приступать к визуализации данных.

**<li>** Последний шаг -- это дизайн, реализованный в соответствии с предыдущими отчетами серии.


**Особенности разработки:**

**<li>** Диаграмма Ганта сформирована с использованием стандартного функционала визуального элемента "Matrix" ("Матрица").

**<li>** Как вы, наверное, уже поняли из описания выше, на каждую задачу, в зависимости от длительности ее выполнения, создается массив записей в разрезе одного дня. Несмотря на это, простота модели обеспечивает быстрое обновление данных, и даже при наличии большого количества задач у вас не возникнет никаких проблем.

**<li>** Для визуализации планируемого прогресса выполнения задачи используется символ "∙".

**<li>** При разработке отчета данные исходного набора значений вносились непосредственно в Power BI (таблица "Перечень задач"), дабы конечный файл не зависел от внешних источников. Переключение на внешние источники данных не составляет проблем.

> *Рвав-рвав, собака Смайл всегда "топит" за стандартный функционал Power BI, поскольку при наличии определенной фантазии можно решить практически любую задачу)*
>
> *Пойду полежу, на улице снова 30 по Цельсию…*
>
> *Ваш Смайл*


**ДЛЯ ЛЮБИТЕЛЕЙ ПОНАЖИМАТЬ НА КНОПОЧКИ**

<iframe width="600" height="373.5" src="https://app.powerbi.com/view?r=eyJrIjoiOTk5YmU5ZjItMTBmMS00ZmUwLWEzODctMGExYjM2NDU3NDYzIiwidCI6IjE4YjFiOTZhLTk0MTQtNDE3MC1iNmNhLTZkODU3NTJlNTZmOCIsImMiOjZ9" frameborder="0" allowFullScreen="true"></iframe>